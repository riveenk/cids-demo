<!DOCTYPE html>
<html class="h-full bg-gray-50" lang="en">

<head h-full bg-gray-50>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="./media/favicon.ico">
    <link rel="stylesheet" type="text/css" href="./style.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="./script.js"></script>
    <title>Colombo Independent Debaters' Society</title>
</head>

<body></body>
<script>
    createNavBar();
</script>
<div class="body-main" id="bodyMain">
    <div class="web-body" id="webBody">
        member portal
        <p id="greeting"></p>
        <button id="logoutBtn">Logout</button>
    </div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        createFooter();

        const supabaseUrl = 'https://whmlpoxodlbtbfbitvxh.supabase.co'
        const supabaseKey = "sb_publishable_2JaIl9xJY-RVuQeNuuW-2Q_liqOwqhd"
        const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

        supabaseClient.auth.getSession().then(({ data: { session } }) => {
            if (!session) {
                window.location.href = "./login.html";
            } else {
                document.getElementById('greeting').textContent = `Welcome, ${session.user.email}`;
            }
        });

        async function logout() {
            const { error } = await supabaseClient.auth.signOut();

            if (error) {
                alert("Logout failed: " + error.message);
            } else {
                window.location.href = "./index.html";
            }
        }


        document.getElementById("logoutBtn").addEventListener("click", logout);
    });
</script>
</body>

</html>